<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Nircek's Snake</title>
<meta name="description" content="A basic JS Snake Project by Nircek">
<meta name="author" content="Nircek">
</head>
<body id="body" onload="init()">
<canvas id="canvas">
<!--TODO: center everything--->
</canvas>
<script>
'use strict';
var WIDTH = 10;
var HEIGHT = 10;
var SQ = 50;
var APPLEM = SQ/6; // appple margin
var PADD = 5;
var MARG = 10;
var MARL = 2; // margin line ("border")
var canvas = undefined;
var ctx = undefined;
function init(){
canvas = document.getElementById('canvas');
ctx = canvas.getContext('2d');
canvas.width=WIDTH*SQ+2*MARG;
canvas.height=HEIGHT*SQ+2*MARG;
ctx.strokeRect(MARL,MARL,WIDTH*SQ+2*MARG-MARL,HEIGHT*SQ+2*MARG-MARL);  // border
getNewApple();
setInterval(update, 1000);
}
function sq(x,y, b=true, m=0){ // TODO: change x,y to object
if(x<0||x>=WIDTH||y<0||y>=HEIGHT)throw RangeError('('+x+', '+y+') is out of map ('+WIDTH+', '+HEIGHT+')');
if(b)ctx.fillRect(MARG+x*SQ+PADD+m,MARG+y*SQ+PADD+m,SQ-2*PADD-2*m,SQ-2*PADD-2*m);
else ctx.clearRect(MARG+x*SQ+PADD+m,MARG+y*SQ+PADD+m,SQ-2*PADD-2*m,SQ-2*PADD-2*m);
}
var direction = 'Up';
var snakePos = [{x:4,y:5}];

function isSamePosition(a, b){
return (a.x==b.x)&&(a.y==b.y);
}

function checkCollision(t){
for(var i=0;i<snakePos.length;++i)if(isSamePosition(snakePos[i],t))return true;
return false;
}

function getNewApple(){
var t;// = undefined;
do{
t = {x:Math.floor(Math.random()*WIDTH),
    y:Math.floor(Math.random()*HEIGHT)}
}while(checkCollision(t));
apple = t;
sq(apple.x,apple.y,true,APPLEM);
}

var apple = undefined;
var body = document.getElementById('body');
body.onkeydown = function(e){if(e.key.substr(0,5)=='Arrow')direction=e.key.substr(5,5)};
function update(){
var dx=0;
var dy=0;
switch(direction){
case 'Up':    dy=-1; break;
case 'Down':  dy=+1; break;
case 'Left':  dx=-1; break;
case 'Right': dx=+1; break;
default: throw RangeError(dircetion+' is not a direction');
}
var l = snakePos[snakePos.length-1];
var n = {x:(WIDTH+l.x+dx)%WIDTH,
       y:(HEIGHT+l.y+dy)%HEIGHT};
// calculations of new x, y
snakePos.push(n);
sq(n.x,n.y);
// add new part
var isApple = isSamePosition(n, apple);
if(!isApple){// delete last part
var s = snakePos.shift();
sq(s.x,s.y, false);
}else getNewApple();
}

</script>
</body>
</html>